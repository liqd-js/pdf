<pdf>
    <header style="margin-left:1.2cm;margin-right:1.2cm;margin-top: 1.2cm; margin-bottom: 2.4mm;">
        <table>
            <tr>
                <td>
                    if( logo )
                    {
                        <img src={ logo } style="padding-top: 1.7px;" />
                    }
                </td>
                <td style="text-align: right;line-height: 1.2em;">
                    <span style="font-size:16px;">{ $('invoice')}<br/><b style="font-size: 18px;">{ _id }</b></span>
                </td>
            </tr>
        </table>
    </header>
    <main style="color:black;margin-left:1.2cm;margin-right:1.2cm;margin-top: 1.2cm;margin-bottom: 1.2cm;font-size: 12px;font-weight:light;line-height:1.35em;">
        <table style="margin-bottom: 4.8mm;">
            <tr style="font-size:8px;color:#666;">
                <td colspan="2" style="padding-top:4.8mm;padding-bottom:1mm;font-weight: medium;">{ $('seller')}:</td>
                <td colspan="2" style="padding-top:4.8mm;padding-left:4.8mm;padding-bottom:1mm;background-color:#f0f0f0;margin-right:-1.2cm;font-weight: medium;">{ $('buyer')}:</td>
            </tr>
            <tr style="font-weight: bold;font-size: 14px;">
                <td colspan="2">{ seller.company || seller.name }</td>
                <td colspan="2" style="padding-left:4.8mm;background-color:#f0f0f0;margin-right:-1.2cm;">{ buyer.company || buyer.name }</td>
            </tr>
            <tr style="line-height: 1.35em;">
                <td>{ seller.address }</td>
                <td rowspan="3">
                    <table>
                        <tr>
                            <td style="width:30%;text-align: right;padding-right:2mm;">if( seller?.crn ){ $('crn') + ':' }</td>
                            <td style="width:80%">if( seller?.crn ){ {seller.crn} }</td>
                        </tr>
                        <tr>
                            <td style="width:30%;text-align: right;padding-right:2mm;">if( seller?.tax ){ $('tax') + ':' }</td>
                            <td style="width:80%">if( seller?.tax ){ {seller.tax} }</td>
                        </tr>
                        <tr>
                            <td style="width:30%;text-align: right;padding-right:2mm;">if( seller?.vat ){ $('vat') + ':' }</td>
                            <td style="width:80%">if( seller?.vat ){ {seller.vat} }</td>
                        </tr>
                    </table>
                </td>
                <td style="padding-left:4.8mm;background-color:#f0f0f0;margin-right:-1.2cm;">{ buyer.address }</td>
                <td rowspan="3" style="padding-left:4.8mm;background-color:#fff0f0;margin-right:-1.2cm;">
                    <table>
                        <tr>
                            <td style="width:30%;text-align: right;padding-right:2mm;background-color:#f0f0f0;">if( buyer?.crn ){ $('crn') + ':' }</td>
                            <td style="background-color:#f0f0f0;width:80%">if( buyer?.crn ){ {buyer.crn} }</td>
                        </tr>
                        <tr>
                            <td style="width:30%;text-align: right;padding-right:2mm;background-color:#f0f0f0;">if( buyer?.tax ){ $('tax') + ':' }</td>
                            <td style="background-color:#f0f0f0;width:80%">if( buyer?.tax ){ {buyer.tax} }</td>
                        </tr>
                        <tr>
                            <td style="width:30%;text-align: right;padding-right:2mm;background-color:#f0f0f0;">if( buyer?.vat ){ $('vat') + ':' }</td>
                            <td style="background-color:#f0f0f0;width:80%">if( buyer?.vat ){ {buyer.vat} }</td>
                        </tr>
                    </table>
                </td>
            </tr>
            <tr style="line-height: 1.35em;">
                <td>{ seller.zip } { seller.city }</td>
                <td style="padding-left:4.8mm;background-color:#f0f0f0;margin-right:-1.2cm;">{ buyer.zip } { seller.city }</td>
            </tr>
            <tr style="line-height: 1.35em;">
                <td>{$(`country.${seller.country}`)}</td>
                <td style="padding-left:4.8mm;background-color:#f0f0f0;margin-right:-1.2cm;">{$(`country.${buyer.country}`)}</td>
            </tr>
            <tr style="font-size:9px;">
                <td colspan="2" style="padding-top:1mm;padding-bottom:4.8mm;padding-right: 4.8mm;color:#666;font-weight: normal;line-height: 1.25em;">#{ note }</td>
                <td colspan="2" style="padding-top:1mm;padding-bottom:4.8mm;background-color:#f0f0f0;margin-right:-1.2cm;"></td>
            </tr>
        </table>
        <div style={`color: white;background-color: #66882f;background-color:brown;background-color:#365fa8;background-color: ${color};margin-left: -1.2cm;padding-left: 1.2cm;margin-right: -1.2cm;margin-bottom:7.2mm;padding-right: 1.2cm;padding-top:7.2mm;padding-bottom:7.2mm;`}>
            <table>
                <tr>
                    <td>{$('issue-date')}:</td>
                    <td style="text-align: right;padding-right:4.8mm;">{ $scope.format.date( issued, { locale: $locale })}</td>
                    <td style="padding-left:4.8mm;">{$('account-number')}:</td>
                    <td style="padding-left:4.8mm;text-align: right;">{( account.prefix.replace(/0+/,'').length ? account.prefix : '' ) + account.number + '/' + account.suffix }</td>
                    if( qr )
                    {
                        <td rowspan="5" style="padding-left:4.8mm;"><img src={qr} style="padding-top: 1.7px;" /></td>
                    }
                </tr>
                <tr>
                    <td>if( typeof due !== 'undefined' ){ <b>{$('due-date')}:</b> }</td>
                    <td style="text-align: right;padding-right:4.8mm;">if( typeof due !== 'undefined' ){ <b>{ $scope.format.date( due, { locale: $locale })}</b> }</td>
                    <td style="padding-left:4.8mm;"><b>{$('variable-symbol')}:</b></td>
                    <td style="padding-left:4.8mm;text-align: right;"><b>{ reference }</b></td>
                </tr>
                <tr>
                    <td>{$('delivery-date')}:</td>
                    <td style="text-align: right;padding-right:4.8mm;">{ $scope.format.date( issued, { locale: $locale })}</td>
                    <td style="padding-left:4.8mm;"><b>{$('iban')}:</b></td>
                    <td style="padding-left:4.8mm;text-align: right;margin-left:-4cm;"><b>{ account._id }</b></td>
                </tr>
                <tr>
                    <td></td>
                    <td style="text-align: right;padding-right:4.8mm;"></td>
                    <td style="padding-left:4.8mm;">{$('bic-swift')}:</td>
                    <td style="padding-left:4.8mm;text-align: right;">{ account.swift }</td>
                </tr>
                <tr>
                    <td style="padding-top:4.8mm;vertical-align:bottom;padding-bottom:3.2px;">{$('payment-method')}:</td>
                    <td style="padding-top:4.8mm;text-align: right;padding-right:4.8mm;text-align: right;vertical-align:bottom;padding-bottom:3.2px;">{ $('payment-'+payment.type) }</td>
                    <td style="padding-top:4.8mm;padding-left:4.8mm;font-weight:bold;vertical-align:bottom;padding-bottom:3.2px;">{ $('amount-to-be-paid')}:</td>
                    <td style="padding-top:4.8mm;padding-left:4.8mm;font-size:22px;text-align: right;">#{ $scope.format.price( price, { locale: $locale, currency, precision: 2, style: 'font-weight:bold' })}</td>
                </tr>
            </table>
        </div>
        <table style="margin-bottom: 7.2mm;">
            <tr style="font-size:8px;color:#666;font-weight: medium;">
                <td style="border-bottom-width:0.5px;border-bottom-color:#000;padding-bottom: 1.2mm;width:3%;"></td>
                <td style="padding-bottom: 1.2mm;border-bottom-width:0.5px;border-bottom-color:#000;width:39%;">{$('item-name')}</td>
                <td style="padding-bottom: 1.2mm;border-bottom-width:0.5px;border-bottom-color:#000;width:8%;text-align:center;">{$('item-code')}</td>
                <td style="padding-right: 1.65mm;padding-bottom: 1.2mm;text-align: right;border-bottom-width:0.5px;border-bottom-color:#000;width:10%;">{$('item-quantity')}</td>
                <td style="padding-right: 1.65mm;padding-bottom: 1.2mm;text-align: right;border-bottom-width:0.5px;border-bottom-color:#000;width:16%;">{$('item-piece-price')}</td>
                <td style="padding-bottom: 1.2mm;text-align: center;border-bottom-width:0.5px;border-bottom-color:#000;width:6%;">{$('vat')}</td>
                <td style="padding-bottom: 1.2mm;text-align: right;border-bottom-width:0.5px;border-bottom-color:#000;width:18%;">{$('total-with-vat')}</td>
            </tr>
            for( let i = 0; i < items.length; ++i )
            {
                let item = items[i];

                <tr>
                    <td style="padding-top: 1.2mm;padding-bottom: 1.2mm;width:3%;">{ i + 1 }.</td>
                    <td style="border-right-width:0.5px;padding-top: 1.2mm;padding-bottom: 1.2mm;padding-right:1.6mm;font-weight: medium;line-height:1.25em;width:39%;">{ item.name }</td>
                    <td style="border-right-width:0.5px;padding-top: 1.2mm;padding-bottom: 1.2mm;width:8%;text-align:center;">{ parseInt( item.id ) < 4294967290 ? item.id : '' }</td>
                    <td style="border-right-width:0.5px;padding-right:1.6mm;padding-top: 1.2mm;padding-bottom: 1.2mm;text-align: right;width:10%;">#{ $scope.format.number( item.quantity, { locale: $locale, style: 'font-weight: medium;' })} ks</td>
                    <td style="border-right-width:0.5px;padding-right:1.6mm;padding-top: 1.2mm;padding-bottom: 1.2mm;text-align: right;width:16%;">
                        #{ $scope.format.price( item.price / ( 1 + ( vat ? item.vat : 0 )), { locale: $locale, currency, precision: 2, style: 'font-weight:medium' })}
                    </td>
                    <td style="border-right-width:0.5px;padding-top: 1.2mm;padding-bottom: 1.2mm;text-align: center;width:6%;">{( vat ? item.vat : 0 ) * 100 } %</td>
                    <td style="padding-left:1.6mm;padding-top: 1.2mm;padding-bottom:1.2mm;text-align: right;width:18%;">#{ $scope.format.price( item.quantity * item.price, { locale: $locale, currency, precision: 2, style: 'font-weight:bold' })}</td>
                </tr>
            }
        </table>
        <table>
            <tr>
                <td style="width:50%">
                {
                    let vats = {}, tax = 0;

                    for( let item of items )
                    {
                        vats[( vat ? item.vat : 0 ) * 100 ] = ( vats[( vat ? item.vat : 0 ) * 100 ] || 0 ) + $scope.format.round( item.price * item.quantity, 2 );
                    }

                    <table>
                        <tr style="font-size:8px;color:#666;font-weight: medium;">
                            <td style="border-bottom-width:0.5px;border-bottom-color:#000;padding-bottom: 1.2mm;width:20%"></td>
                            <td style="border-bottom-width:0.5px;border-bottom-color:#000;padding-bottom: 1.2mm;text-align: right;width:28%">{$('basis')}</td>
                            <td style="border-bottom-width:0.5px;border-bottom-color:#000;padding-bottom: 1.2mm;text-align: right;width:24%">{$('vat')}</td>
                            <td style="border-bottom-width:0.5px;border-bottom-color:#000;padding-bottom: 1.2mm;text-align: right;width:28%">{$('total')}</td>
                        </tr>
                        for( let vat in vats )
                        {
                            tax += $scope.format.round( vats[vat], 2 ) - $scope.format.round( $scope.format.round( vats[vat], 2 ) / ( 1 + vat / 100 ), 4 );

                            <tr>
                                <td style="padding-top: 1.2mm;padding-bottom: 1.2mm;width:22%">{$('vat')} { vat } %</td>
                                <td style="padding-top: 1.2mm;padding-bottom: 1.2mm;text-align: right;width:27%">#{ $scope.format.number( $scope.format.round( $scope.format.round( vats[vat], 2 ) / ( 1 + vat / 100 ), 4 ), { locale: $locale, precision: 2 })}</td>
                                <td style="padding-top: 1.2mm;padding-bottom: 1.2mm;text-align: right;width:24%">#{ $scope.format.number( $scope.format.round( vats[vat], 2 ) - $scope.format.round( $scope.format.round( vats[vat], 2 ) / ( 1 + vat / 100 ), 4 ), { locale: $locale, precision: 2 })}</td>
                                <td style="padding-top: 1.2mm;padding-bottom: 1.2mm;text-align: right;width:27%">#{ $scope.format.number( vats[vat], { locale: $locale, precision: 2 })}</td>
                            </tr>
                        }
                        <tr>
                            <td style="border-top-width:0.5px;border-top-color:#000;padding-top: 1.2mm;padding-bottom: 1.2mm;width:22%"><span style="font-weight: medium;">{$('total')}</span></td>
                            <td style="border-top-width:0.5px;border-top-color:#000;padding-top: 1.2mm;padding-bottom: 1.2mm;text-align: right;width:27%">#{ $scope.format.number( price - tax, { locale: $locale, precision: 2, style: 'font-weight: medium;' })}</td>
                            <td style="border-top-width:0.5px;border-top-color:#000;padding-top: 1.2mm;padding-bottom: 1.2mm;text-align: right;width:24%">#{ $scope.format.number( tax, { locale: $locale, precision: 2, style: 'font-weight: medium;' })}</td>
                            <td style="border-top-width:0.5px;border-top-color:#000;padding-top: 1.2mm;padding-bottom: 1.2mm;text-align: right;width:27%">#{ $scope.format.number( price, { locale: $locale, precision: 2, style: 'font-weight: medium;' })}</td>
                        </tr>
                        <tr>
                            <td colspan="4"><div style="margin-top:2.4mm">{$('vat-breakdown')} { currency }</div></td>
                        </tr>
                    </table>
                }
                </td>
                <td style="width:50%">
                    <table>
                        <tr>
                            <td style="text-align: right;font-weight: medium;font-size:18px;padding-top:1mm;">{$('total')}</td>
                            <td style="text-align: right;font-size:22px;">#{ $scope.format.price( price, { locale: $locale, currency, precision: 2, style: 'font-weight:bold' })}</td>
                        </tr>
                    </table>
                </td>
            </tr>
        </table>
    </main>
    <footer style="margin-left:1.2cm;margin-right:1.2cm;margin-bottom: 1.2cm;">/*
        <p style="margin-bottom: 20px;"><b>$('supplier'):</b></p>
        <p style="font-size: 12px"><b>{ seller.name }</b></p>
        <p>{ seller.address }<br/>{ seller.zip } { seller.city }<br/>{ seller.country }</p>
        <p>{ seller.phone }<br/>{ seller.email }</p>
        <p style="text-align: center;margin-top:20px; font-size: 8px; color: #333;">{$('page')} { $page }</p>*/
    </footer>
</pdf>